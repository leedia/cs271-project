<!DOCTYPE html>

<html lang="en">
  <head>
    
    <title>EEG-Decisions</title>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.4.0/dist/leaflet.css" integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA==" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js" integrity="sha512-QVftwZFqvtRNi0ZyCtsznlKSWOStnDORoefr1enyq5mVL4tmKB3S/EnC3rRJcxCPavG10IcrVGSmPh6Qw5lwrg==" crossorigin=""></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">


  </head>

  <body>
    <div class = "container">
      <div class = "row">
        <div class = "col-md-6">
          <h2>Time Series</h2>

        </div>
        <div class = "col-md-6">
          <h2>Map</h2>
          <div id="mapid" style="width: 1000px; height: 1000px;"></div>
        </div>
      </div>
    </div>

    <script>

      $.get('data/location.csv', function(data) {

        function csvToArray(csvString) {

          var csvArray = [];
          var csvRows = csvString.split(/\n/);
          var csvHeaders = csvRows.shift().split(','); // split headers

          for (var rowIndex = 0; rowIndex < csvRows.length-1; ++rowIndex) {
            var rowArray = csvRows[rowIndex].split(',');
            var rowObject = csvArray[rowIndex] = {};
            for (var propIndex = 0; propIndex < rowArray.length; ++propIndex) {
              var propValue = rowArray[propIndex];
              var propLabel = csvHeaders[propIndex];
              rowObject[propLabel] = propValue;
            }
          }
          return csvArray;
        }

        var latlngs = [];

        data = csvToArray(data);
        data.forEach(function(item) {
          console.log(parseFloat(item.latitude))
          latlngs.push([parseFloat(item.latitude), parseFloat(item.longitude)]);
        });

        var map = L.map('mapid').setView([42.374208, -71.116687], 13);

        L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
          maxZoom: 18,
          attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
            '<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
            'Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
          id: 'mapbox.streets'
        }).addTo(map);

        L.marker([42.374208, -71.116687]).addTo(map)
          .bindPopup("<b>Hello world!</b><br />I am a popup.").openPopup();

        var polyline = L.polyline(latlngs, {color: 'red', opacity: 0.3}).addTo(map);
        // zoom the map to the polyline
        map.fitBounds(polyline.getBounds());

        var popup = L.popup();

        function onMapClick(e) {
          popup
            .setLatLng(e.latlng)
            .setContent("You clicked the map at " + e.latlng.toString())
            .openOn(map);
        }

        map.on('click', onMapClick);

      });

    </script>

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

  </body>
</html>